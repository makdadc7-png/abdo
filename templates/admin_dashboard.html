{% extends "base_admin.html" %}

{% block content %}

<h1 class="admin-page-title">Tableau de bord</h1>

<!-- ===== CARTES STATISTIQUES ===== -->
<div class="admin-stats-row">
  <div class="admin-stat-card">
    <div class="stat-icon">üìÖ</div>
    <div class="stat-label">Nombre de r√©servations</div>
    <div class="stat-value">{{ total_reservations }}</div>
  </div>

  <div class="admin-stat-card">
    <div class="stat-icon">üöó</div>
    <div class="stat-label">V√©hicules disponibles</div>
    <div class="stat-value">{{ total_disponibles }}</div>
  </div>

  <div class="admin-stat-card">
    <div class="stat-icon">‚úÖ</div>
    <div class="stat-label">Lou√©s</div>
    <div class="stat-value">{{ total_loues }}</div>
  </div>

  <div class="admin-stat-card">
    <div class="stat-icon">üë§</div>
    <div class="stat-label">Clients</div>
    <div class="stat-value">{{ total_clients }}</div>
  </div>
</div>

<!-- ===== SECTIONS DU BAS ===== -->
<div class="admin-section-row">

  <!-- Voitures accident√©es -->
  <section class="admin-section">
    <div class="admin-section-header danger">
      <div class="section-title-left">
        <span class="section-icon">‚ö†Ô∏è</span>
        <h2>Voitures accident√©es</h2>
      </div>
    </div>

    {% if accident_cars %}
      <table class="admin-table">
        <thead>
          <tr>
            <th>Voiture</th>
            <th>Statut</th>
            <th>D√©g√¢t</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          {% for v in accident_cars %}
          <tr>
            <td>{{ v.nom }}</td>
            <td>{{ v.statut }}</td>
            <td>{{ v.degat }}</td>
            <td class="admin-table-actions">
              <a href="{{ url_for('admin_voitures_detail', voiture_id=v.id) }}">Voir / Modifier</a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p class="admin-empty">Aucune voiture accident√©e pour le moment.</p>
    {% endif %}
  </section>

  <!-- Voitures proches de la visite technique -->
  <section class="admin-section">
    <div class="admin-section-header warning">
      <div class="section-title-left">
        <span class="section-icon">üõ†Ô∏è</span>
        <h2>Voitures proches de la visite technique</h2>
      </div>
    </div>

    {% if visite_cars %}
      <table class="admin-table">
        <thead>
          <tr>
            <th>Voiture</th>
            <th>Date derni√®re visite</th>
            <th>Prochaine visite</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          {% for v in visite_cars %}
          <tr>
            <td>{{ v.nom }}</td>
            <td>{{ v.derniere_visite }}</td>
            <td>{{ v.prochaine_visite }}</td>
            <td class="admin-table-actions">
              <a href="{{ url_for('admin_voitures_detail', voiture_id=v.id) }}">Voir</a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p class="admin-empty">Aucune visite technique proche.</p>
    {% endif %}
  </section>

  <!-- Assurance bient√¥t expir√©e -->
  <section class="admin-section">
    <div class="admin-section-header assurance">
      <div class="section-title-left">
        <span class="section-icon">üõ°Ô∏è</span>
        <h2>Assurance bient√¥t expir√©e</h2>
      </div>
    </div>

    {% if assurance_cars %}
      <table class="admin-table">
        <thead>
          <tr>
            <th>Voiture</th>
            <th>Date fin d‚Äôassurance</th>
            <th>Jours restants</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody>
          {% for v in assurance_cars %}
          <tr>
            <td>{{ v.nom }}</td>
            <td>{{ v.assurance_fin }}</td>
            <td>{{ v.jours_restants }}</td>
            <td class="admin-table-actions">
              <a href="{{ url_for('admin_voitures_detail', voiture_id=v.id) }}">Voir / Renouveler</a>
            </td>
          </tr>
          {% endfor %}
        </tbody>
      </table>
    {% else %}
      <p class="admin-empty">Aucune assurance proche de l‚Äôexpiration.</p>
    {% endif %}
  </section>

</div>



{% endblock %}
